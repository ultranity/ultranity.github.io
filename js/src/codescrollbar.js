function ModifyScrollPos(r){if(g_TrackParam.bindding){var a=r.getBoundingClientRect(),t=r.scrollWidth,e=$("#Scrollbar-Track"),o=$("#Scrollbar-Handle");if(a.width<t){var n=document.documentElement.clientHeight||document.body.clientHeight,c=a.bottom<n+0?-100:n;c>0?(c=c>a.top?c:a.top,e.width(a.width),e.css("left",a.left),e.css("top",c-e.height()),o.width(parseInt(a.width/t*a.width)),o.css("left",parseInt(r.scrollLeft/t*a.width))):e.css("top",-20)}else e.css("top",-20)}}function UnBindScroll(){g_TrackParam.mouseDown?g_TrackParam.timerhandle=setTimeout(function(){UnBindScroll()},1e3):($("#Scrollbar-Track").hide(),g_TrackParam.bindding=!1)}function BindScrollTo(r){g_TrackParam.mouseDown||(clearTimeout(g_TrackParam.timerhandle),g_TrackParam.bindding=!0,0==$("#Scrollbar-Track").length?$(r).append('<div id="Scrollbar-Track" class="Scrollbar-Track"><div id="Scrollbar-Handle" class="Scrollbar-Handle"></div> </div>'):$(r).append($("#Scrollbar-Track")),$("#Scrollbar-Track").show(),window.onscroll=function(){ModifyScrollPos(r)},window.onresize=function(){ModifyScrollPos(r)},$(r).resize(function(){ModifyScrollPos(r)}),$(r).scroll(function(){ModifyScrollPos(r)}),addEvent(r,"mousemove",function(a){g_TrackParam.bindding||BindScrollTo(r)}),addEvent(r,"mouseup",function(a){g_TrackParam.bindding||BindScrollTo(r)}),ModifyScrollPos(r),startDrag($("#Scrollbar-Handle")[0],$("#Scrollbar-Track")[0],function(a,t){var e=r.getBoundingClientRect(),o=r.scrollWidth;r.scrollLeft=parseInt(a/e.width*o)}))}var g_TrackParam={left:0,top:0,currentX:0,currentY:0,maxLeft:0,maxTop:0,mouseDown:!1,bindding:!1,timerhandle:0},getCss=function(r,a){return r.currentStyle?r.currentStyle[a]:document.defaultView.getComputedStyle(r,!1)[a]},startDrag=function(r,a,t){"auto"!==getCss(r,"left")&&(g_TrackParam.left=getCss(r,"left")),"auto"!==getCss(r,"top")&&(g_TrackParam.top=getCss(r,"top")),"auto"!==getCss(a,"width")&&(g_TrackParam.maxLeft=parseInt(getCss(a,"width"))-parseInt(getCss(r,"width")));var e=function(){g_TrackParam.mouseDown=!1,g_TrackParam.bindding&&($("#Scrollbar-Track").removeClass("Scrollbar-Trackhover"),$("#Scrollbar-Handle").removeClass("Scrollbar-Handlehover"),"auto"!==getCss(r,"left")&&(g_TrackParam.left=getCss(r,"left")),"auto"!==getCss(r,"top")&&(g_TrackParam.top=getCss(r,"top")),removeEvent(document,"mouseup",e),removeEvent(document,"mousemove",o))},o=function(a){var e=a||window.event;if(g_TrackParam.mouseDown){var o=e.clientX,n=e.clientY,c=o-g_TrackParam.currentX,l=n-g_TrackParam.currentY,s=parseInt(g_TrackParam.left)+c;return r.style.left=parseInt(s>0?s<g_TrackParam.maxLeft?s:g_TrackParam.maxLeft:0)+"px",e.preventDefault&&e.preventDefault(),"function"==typeof t&&t(parseInt(g_TrackParam.left)+c,parseInt(g_TrackParam.top)+l),!1}};r.onmousedown=function(a){var t=a||window.event;g_TrackParam.currentX=t.clientX,g_TrackParam.currentY=t.clientY,g_TrackParam.left=r.style.left,g_TrackParam.top=r.style.top,g_TrackParam.mouseDown=!0,$("#Scrollbar-Track").addClass("Scrollbar-Trackhover"),$("#Scrollbar-Handle").addClass("Scrollbar-Handlehover"),addEvent(document,"mouseup",e),addEvent(document,"mousemove",o),r.onselectstart=function(){return!1}}};